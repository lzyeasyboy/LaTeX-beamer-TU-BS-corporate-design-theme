% Copyright 2007 by Marco Barisione
%
% This file may be distributed and/or modified
%
% 1. under the LaTeX Project Public License and/or
% 2. under the GNU Public License.

\mode<presentation>

% String used between the current page and the total page count.
\def\beamer@tubs@pageofpages{/}
\DeclareOptionBeamer{pageofpages}{\def\beamer@tubs@pageofpages{#1}}

%% Image used for the watermark.
%\def\beamer@tubs@watermarkorig{}
%\DeclareOptionBeamer{watermark}{\def\beamer@tubs@watermarkorig{#1}}
%
%% Height of the watermark.
%\def\beamer@tubs@watermarkheight{100px}
%\DeclareOptionBeamer{watermarkheight}{\def\beamer@tubs@watermarkheight{#1}}
%
%% The original image height is watermarkheightmult * watermarkheight.
%\def\beamer@tubs@watermarkheightmult{1}
%\DeclareOptionBeamer{watermarkheightmult}{\def\beamer@tubs@watermarkheightmult{#1}}
%
\ExecuteOptionsBeamer{titleline=false}
\ProcessOptionsBeamer
%
%% Enable/disable the watermark.
%\def\watermarkon{%
%  \def\beamer@tubs@watermark{\beamer@decolines@watermarkorig}%
%}
%\def\watermarkoff{\def\beamer@tubs@watermark{}}
%
%% Initially enable the watermark.
%\watermarkon

% Colors.
\setbeamercolor*{page header}{parent=palette secondary}
\setbeamercolor*{frametitle}{parent=palette secondary}
\setbeamercolor*{footline}{parent=palette primary}

% Lengths
\newlength{\headerheight}
\setlength{\headerheight}{.126\paperheight}

\newlength{\beamer@tubs@foot@logowidth}
\setlength{\beamer@tubs@foot@logowidth}{.19\paperwidth}

\newlength{\beamer@tubs@foot@logoheight}
\setlength{\beamer@tubs@foot@logoheight}{.1\paperheight}

\newlength{\beamer@tubs@headsep}
\setlength{\beamer@tubs@headsep}{0.5cm}

\newlength{\beamer@tubs@headmargin}
\setlength{\beamer@tubs@headmargin}{\beamer@tubs@normalmargin}
\addtolength{\beamer@tubs@headmargin}{-\beamer@tubs@headsep}

% The height of the watermark part below the 3 bottom lines.
%\newlength{\beamer@tubs@watermarkheightbottom}
%\addtolength{\beamer@tubs@watermarkheightbottom}{\beamer@decolines@lineup}
%\addtolength{\beamer@tubs@watermarkheightbottom}{\beamer@decolines@linemid}
%\addtolength{\beamer@tubs@watermarkheightbottom}{\beamer@decolines@linebottom}

% The height of the watermark part over the 3 bottom lines before shrinking.
%\newlength{\beamer@tubs@watermarkheightupperorig}
%\setlength{\beamer@tubs@watermarkheightupperorig}{\beamer@decolines@watermarkheight}
%\addtolength{\beamer@tubs@watermarkheightupperorig}{-\beamer@decolines@watermarkheightbottom}
%\multiply\beamer@tubs@watermarkheightupperorig by \beamer@decolines@watermarkheightmult

% Footer.
\defbeamertemplate*{footline}{tubs theme}
{
  \leavevmode%
  % Page number.
%  \hbox{%
%  \begin{beamercolorbox}[wd=.2\paperwidth,ht=0ex,dp=0ex,center]{}%
%    \usebeamerfont{palette primary}\insertframenumber{} \beamer@tubs@pageofpages{} \inserttotalframenumber%
%  \end{beamercolorbox}%
%  \begin{beamercolorbox}[wd=.8\paperwidth,ht=0ex,dp=0ex]{}%
%  \end{beamercolorbox}%
%  } %
  \includegraphics[width=\beamer@tubs@foot@logowidth]{\beamer@tubs@titlepagelogo}
  \vbox{}\vskip-.7\beamer@tubs@foot@logoheight
  \hskip \beamer@tubs@foot@logowidth
  \vbox{
	  \begin{beamercolorbox}[wd=\paperwidth,ht=1pt,dp=0pt]{footline}%
	  \end{beamercolorbox}%

	  \begin{beamercolorbox}[leftskip=0.5cm,sep=1pt,ht=.7\beamer@tubs@gaussmargin]{}
		  \insertdate{} | \insertauthor{} | \inserttitle{} | Seite \insertframenumber{} \beamer@tubs@pageofpages{} \inserttotalframenumber
	  \end{beamercolorbox}
  }
  \vspace{.7\beamer@tubs@foot@logoheight}
  \vspace{.3\beamer@tubs@gaussmargin}  % (1 - 0.7)
   
  % This seems to fix some alignment problems with the watermark. It has to be
  % always applied if you do not want to see the footer moving up and down when
  % moving from a page with watermark to a page without or vice versa.
%  \vskip-.5px%
  % Watermark.
%  \if\beamer@tubs@watermark\@empty\else%
%    \vskip-\beamer@tubs@watermarkheightbottom%
%    \llap{\includegraphics[height=\beamer@tubs@watermarkheightbottom,clip=true,%
%      trim=0pt 0pt 0pt \beamer@tubs@watermarkheightupperorig]{\beamer@decolines@watermark}\hskip-\paperwidth}%
%  \fi%
}

\defbeamertemplate*{headline}{tubs theme}
%{}

\defbeamertemplate*{frametitle}{tubs theme}[1][left]
{
  \ifbeamercolorempty[bg]{frametitle}{}{\nointerlineskip}%
  \@tempdima=\textwidth%
  \advance\@tempdima by\beamer@leftmargin%
  \advance\@tempdima by\beamer@rightmargin%
  \begin{beamercolorbox}[wd=\the\@tempdima,ht=\headerheight,leftskip=\beamer@tubs@headmargin,sep=\beamer@tubs@headsep]{frametitle}
    \usebeamerfont{frametitle}%
 	 \vskip-1ex 
    \if@tempswa\else\csname beamer@fte#1\endcsname\fi%
    \strut\insertframetitle\strut\par%
    {%
      \ifx\insertframesubtitle\@empty%
      \else%
      {\usebeamerfont{framesubtitle}\usebeamercolor[fg]{framesubtitle}\insertframesubtitle\strut\par}%
      \fi
    }%
    \vskip-1ex%
    \if@tempswa\else\vskip-.3cm\fi% set inside beamercolorbox... evil here...
  \end{beamercolorbox}%
}


% Frame title continuations, default
\defbeamertemplate*{frametitle continuation}{tubs theme}{(\insertcontinuationcount)}

%\defbeamertemplate*{sidebar right}{tubs theme}
%{
%  \vskip.1\beamer@leftmargin%
%  \llap{\insertlogo\hskip.5\beamer@leftmargin}%
%  \vfill%
%  \if\beamer@tubs@watermark\@empty\else%
%  \llap{\includegraphics[height=\beamer@tubs@watermarkheight]{\beamer@decolines@watermark}}%
%  \vskip-\beamer@tubs@watermarkheightbottom%
%  \fi
%}

\mode
<all>
